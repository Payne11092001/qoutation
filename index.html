<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sales Order</title>

<!-- html2pdf.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root {
  --border: #000;
  --grid-gray: #555;
  --purple: #b7a7d9;
  --yellow: #f6e08b;
  --bg: #ffffff;
  --text: #000;
  --cell-pad: 6px;
  --font: Arial, Helvetica, sans-serif;
}

html, body {
  background: #f6f7fb;
  margin: 0;
  padding: 12px;
  color: var(--text);
  font-family: var(--font);
  font-size: 14px;
  line-height: 1.4;
}

.toolbar {
  display: flex;
  gap: 10px;
  margin: 0 auto 12px;
  max-width: 900px;
  align-items: center;
  justify-content: flex-end;
  flex-wrap: wrap;
}

.btn {
  border: 1px solid #0d6efd;
  background: #0d6efd;
  color: #fff;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: 0.2s ease;
}
.btn:hover {
  opacity: 0.9;
}
.btn-danger {
  background: #dc3545;
  border-color: #dc3545;
}

.sheet {
  width: 100%;
  max-width: 210mm; /* Keep responsive but limit to A4 */
  margin: 0 auto 14px;
  background: var(--bg);
  border: 1px solid #ddd;
  border-radius: 8px;
  box-shadow: 0 8px 18px rgba(16,24,40,.06);
  padding: 12px;
  box-sizing: border-box;
}

.table-wrap {
  overflow-x: auto;
  width: 100%;
}

table {
  border-collapse: collapse;
  width: 100%;
  font-size: 13px;
  word-break: break-word;
}

th, td {
  border: 1px solid var(--border);
  padding: var(--cell-pad);
  vertical-align: middle;
  background: #fff;
  text-align: left;
}

.title-row th {
  background: var(--grid-gray);
  color: #fff;
  font-weight: bold;
  font-size: 14px;
  text-align: center;
}

.purple {
  background: var(--purple);
  font-weight: bold;
  text-align: center;
}
.no-border {
  border: 0 !important;
}
.label {
  font-weight: bold;
  white-space: nowrap;
}
.total-row td {
  background: var(--yellow);
  font-weight: bold;
}
.note-cell {
  white-space: nowrap;
  font-weight: bold;
  width: 12%;
}

input[type="text"],
input[type="date"],
input[type="number"],
textarea {
  width: 100%;
  border: none;
  outline: none;
  font-family: inherit;
  font-size: 13px;
  background: transparent;
  padding: 2px;
  box-sizing: border-box;
}
textarea {
  resize: none;
  height: 60px;
}

@page {
  size: A4;
  margin: 10mm;
}
@media print {
  body {
    background: #fff;
    padding: 0;
  }
  .toolbar {
    display: none;
  }
  .sheet {
    box-shadow: none;
    border: 0;
    margin: 0 auto;
    border-radius: 0;
    padding: 0;
    width: 210mm; /* force exact A4 width */
  }
}

@media (max-width: 768px) {
  body {
    padding: 6px;
  }
  .sheet {
    padding: 8px;
  }
  table {
    font-size: 12px;
  }
  .btn {
    padding: 6px 10px;
    font-size: 12px;
  }
}

</style>
</head>
<body>

<div class="toolbar">
  <button class="btn" onclick="addRow()">âž• Add Row</button>
<button class="btn" onclick="savePDF()">ðŸ’¾ Save as PDF</button>
</div>

<div id="printArea">
  <section class="sheet">
    <div class="table-wrap">
      <table aria-label="Sales Order" id="orderTable">
        <colgroup>
          <col style="width:20%">
          <col style="width:10%">
          <col style="width:34%">
          <col style="width:14%">
          <col style="width:14%">
          <col style="width:2%">
          <col style="width:18%">
          <col style="width:12%">
          <col style="width:10%">
        </colgroup>

        <tbody>
        <!-- Title -->
        <tr class="title-row">
          <th colspan="5">Sale's Order</th>
          <th class="no-border"></th>
          <th colspan="3">Mode of payment</th>
        </tr>

        <!-- Company / Date / Payment row -->
        <tr>
          <td class="label">Company name:</td>
          <td colspan="4"><input type="text" /></td>
          <td class="no-border"></td>
          <td class="label">Cash:</td>
          <td colspan="4"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td class="label">Address:</td>
          <td colspan="4"><input type="text" /></td>
          <td class="no-border"></td>
          <td class="label">Gcash:</td>
          <td colspan="4"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td class="label">Order Date:</td>
          <td colspan="4"><input type="date" /></td>
          <td class="no-border"></td>
          <td class="label">Bank Transfer:</td>
          <td colspan="4"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td class="label">Delivery Date:</td>
          <td colspan="4"><input type="date" /></td>
          <td class="no-border"></td>
          <td class="label">Cheque:</td>
          <td colspan="4"><input type="checkbox" /></td>
        </tr>

        <!-- TAX & CLIENT Section -->
        <tr>
          <th class="purple text-center" colspan="2">TAX</th>
          <th class="purple text-center" colspan="3">CLIENT</th>
          <td class="no-border"></td>
          <th class="purple">Production Needs</th>
          <th><input type="checkbox" /> 8A</th>
          <th><input type="checkbox"/>Customize</th>
        </tr>
        <tr>
          <td colspan="2">w/out commission:</td>
          <td colspan="3">Distributor: <input type="checkbox" /></td>
          <td class="no-border"></td>
          <td>Inspection Tag:</td>
          <td colspan="2"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td colspan="2">w/ commission:</td>
          <td colspan="3">Non Distributor: <input type="checkbox" /></td>
          <td class="no-border"></td>
          <td>Expiration Date:</td>
          <td colspan="2"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td colspan="2">w/ bfp commission:</td>
          <td colspan="3">End User: <input type="checkbox" /></td>
          <td class="no-border"></td>
          <td>Mfg Date:</td>
          <td colspan="2"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td colspan="2">Vat included:</td>
          <td colspan="3">Corporate: <input type="checkbox" /></td>
          <td class="no-border"></td>
          <td>Serial No.:</td>
          <td colspan="2"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td colspan="2">Vat excluded: <input type="checkbox" /></td>
          <td colspan="3">SALES OFFICER: <input type="text" /></td>
          <td class="no-border"></td>
          <td>Only do not test and press handle:</td>
          <td colspan="2"><input type="checkbox" /></td>
        </tr>
        <tr>
          <td colspan="2">w/ ewt 1%: <input type="checkbox" /></td>
          <td colspan="3"></td>
        </tr>

        <!-- Headers: Items -->
        <tr>
          <th class="purple">QTY</th>
          <th class="purple">Unit</th>
          <th class="purple" colspan="2">Articles</th>
          <th class="purple">PRICE</th>
          <th class="purple" colspan="3">Amount</th>
          <th class="purple">Action</th>
        </tr>

        <!-- Sample Initial Row -->
        <tr class="item-row">
          <td><input type="number" class="qty" oninput="calculateTotal()" /></td>
          <td><input type="text" /></td>
          <td colspan="2"><input type="text" /></td>
          <td><input type="number" step="0.01" class="price" oninput="calculateTotal()" /></td>
          <td colspan="3" class="amount"></td>
          <td><button class="btn btn-danger" onclick="removeRow(this)">ðŸ—‘</button></td>
        </tr>

        <!-- Total Price Row -->
        <tr class="total-row">
          <td colspan="5" style="text-align:right;">Total Price:</td>
          <td colspan="4"><input type="number" step="0.01" id="totalPrice" readonly /></td>
        </tr>

        <!-- Notes -->
        <tr>
          <td class="note-cell">Note:</td>
          <td colspan="12"><textarea name="note"></textarea></td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>
</div>

<script>
function calculateTotal(){
  let rows = document.querySelectorAll(".item-row");
  let total = 0;
  rows.forEach(row=>{
    let qty = parseFloat(row.querySelector(".qty")?.value) || 0;
    let price = parseFloat(row.querySelector(".price")?.value) || 0;
    let amount = qty * price;
    row.querySelector(".amount").textContent = amount > 0 ? amount.toFixed(2) : "";
    total += amount;
  });
  document.getElementById("totalPrice").value = total.toFixed(2);
}

function addRow(){
  let table = document.getElementById("orderTable").querySelector("tbody");
  let totalRow = table.querySelector(".total-row");

  let newRow = document.createElement("tr");
  newRow.classList.add("item-row");
  newRow.innerHTML = `
    <td><input type="number" class="qty" oninput="calculateTotal()" /></td>
    <td><input type="text" /></td>
    <td colspan="2"><input type="text" /></td>
    <td><input type="number" step="0.01" class="price" oninput="calculateTotal()" /></td>
    <td colspan="3" class="amount"></td>
    <td><button class="btn btn-danger" onclick="removeRow(this)">ðŸ—‘</button></td>
  `;
  table.insertBefore(newRow, totalRow);
}

function removeRow(btn){
  let row = btn.closest("tr");
  row.remove();
  calculateTotal();
}

function savePDF() {
  const element = document.getElementById("printArea");

  // Temporarily force exact A4 width
  element.style.width = "210mm";

  const opt = {
    margin: 0,
    filename: 'sales-order.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2, useCORS: true },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().set(opt).from(element).save().then(() => {
    // Reset after saving so it's responsive again
    element.style.width = "100%";
  });
}
</script>


</body>
</html>
